lstm-rnn-01.md

model:

# fit and evaluate a model
def evaluate_model(trainX, trainy, testX, testy):
    verbose, epochs = 1, 20
    
    n_features = 50
    n_outputs = 2
    n_steps_per_epoch = len(trainX)
    print(f"Steps per epoch: {n_steps_per_epoch}")
    
    lstm_units = 100
        
    model = Sequential()
    model.add(LSTM(lstm_units, input_shape=(None, n_features)))
    model.add(Dropout(0.5))
    model.add(Dense(lstm_units, activation='relu'))
    model.add(Dense(n_outputs, activation='softmax'))
    model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
    
    print(model.summary())
    # fit network
    model.fit_generator(train_generator(trainX, trainy), steps_per_epoch=n_steps_per_epoch, epochs=epochs, verbose=verbose)
    # evaluate model
    _, accuracy = model.evaluate_generator(train_generator(testX, testy), steps=len(testX), verbose=0)
    
    return accuracy

results:

Steps per epoch: 90
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_1 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 5s 53ms/step - loss: 0.7762 - accuracy: 0.5000
Epoch 2/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7478 - accuracy: 0.5222
Epoch 3/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7521 - accuracy: 0.4556
Epoch 4/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7628 - accuracy: 0.5000
Epoch 5/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7703 - accuracy: 0.4556
Epoch 6/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7396 - accuracy: 0.4556
Epoch 7/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7713 - accuracy: 0.4111
Epoch 8/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7708 - accuracy: 0.3444
Epoch 9/20
90/90 [==============================] - 5s 50ms/step - loss: 0.7215 - accuracy: 0.4889
Epoch 10/20
90/90 [==============================] - 4s 43ms/step - loss: 0.6968 - accuracy: 0.6222
Epoch 11/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7177 - accuracy: 0.4778
Epoch 12/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7343 - accuracy: 0.4222
Epoch 13/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7446 - accuracy: 0.4222
Epoch 14/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7289 - accuracy: 0.4667
Epoch 15/20
90/90 [==============================] - 4s 46ms/step - loss: 0.7015 - accuracy: 0.4667
Epoch 16/20
90/90 [==============================] - 4s 46ms/step - loss: 0.7168 - accuracy: 0.5333
Epoch 17/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7144 - accuracy: 0.4444
Epoch 18/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7172 - accuracy: 0.4778
Epoch 19/20
90/90 [==============================] - 6s 70ms/step - loss: 0.7020 - accuracy: 0.4778
Epoch 20/20
90/90 [==============================] - 4s 49ms/step - loss: 0.7205 - accuracy: 0.4000
>#1 validation accuracy: 65.217
Steps per epoch: 90
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_2 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_2 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 6s 64ms/step - loss: 0.9095 - accuracy: 0.4778
Epoch 2/20
90/90 [==============================] - 5s 57ms/step - loss: 0.6884 - accuracy: 0.6000
Epoch 3/20
90/90 [==============================] - 4s 42ms/step - loss: 0.7263 - accuracy: 0.5556
Epoch 4/20
90/90 [==============================] - 5s 50ms/step - loss: 0.7312 - accuracy: 0.5111
Epoch 5/20
90/90 [==============================] - 5s 59ms/step - loss: 0.7421 - accuracy: 0.4667
Epoch 6/20
90/90 [==============================] - 4s 47ms/step - loss: 0.7022 - accuracy: 0.5333
Epoch 7/20
90/90 [==============================] - 4s 44ms/step - loss: 0.8044 - accuracy: 0.3667
Epoch 8/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7437 - accuracy: 0.4000
Epoch 9/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7269 - accuracy: 0.4333
Epoch 10/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7081 - accuracy: 0.5111
Epoch 11/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7427 - accuracy: 0.4444
Epoch 12/20
90/90 [==============================] - 4s 46ms/step - loss: 0.7052 - accuracy: 0.4889
Epoch 13/20
90/90 [==============================] - 4s 46ms/step - loss: 0.7125 - accuracy: 0.4778
Epoch 14/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7307 - accuracy: 0.4889
Epoch 15/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7341 - accuracy: 0.4667
Epoch 16/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7457 - accuracy: 0.4556
Epoch 17/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7335 - accuracy: 0.4556
Epoch 18/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7028 - accuracy: 0.5111
Epoch 19/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7338 - accuracy: 0.4667
Epoch 20/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7204 - accuracy: 0.4778
>#2 validation accuracy: 65.217
Steps per epoch: 90
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_3 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_3 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_6 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 5s 51ms/step - loss: 0.7176 - accuracy: 0.5778
Epoch 2/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7775 - accuracy: 0.4556
Epoch 3/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7343 - accuracy: 0.6000
Epoch 4/20
90/90 [==============================] - 4s 43ms/step - loss: 0.6999 - accuracy: 0.5111
Epoch 5/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7417 - accuracy: 0.4556
Epoch 6/20
90/90 [==============================] - 5s 57ms/step - loss: 0.7507 - accuracy: 0.5000
Epoch 7/20
90/90 [==============================] - 5s 52ms/step - loss: 0.7535 - accuracy: 0.3667
Epoch 8/20
90/90 [==============================] - 5s 52ms/step - loss: 0.7419 - accuracy: 0.4000
Epoch 9/20
90/90 [==============================] - 5s 53ms/step - loss: 0.7309 - accuracy: 0.4667
Epoch 10/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7328 - accuracy: 0.3778
Epoch 11/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7090 - accuracy: 0.5000
Epoch 12/20
90/90 [==============================] - 4s 45ms/step - loss: 0.7283 - accuracy: 0.4778
Epoch 13/20
90/90 [==============================] - 5s 57ms/step - loss: 0.7123 - accuracy: 0.4556
Epoch 14/20
90/90 [==============================] - 5s 61ms/step - loss: 0.7079 - accuracy: 0.5222
Epoch 15/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7154 - accuracy: 0.4778
Epoch 16/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7011 - accuracy: 0.5333
Epoch 17/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7199 - accuracy: 0.5333
Epoch 18/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7306 - accuracy: 0.4111
Epoch 19/20
90/90 [==============================] - 5s 53ms/step - loss: 0.7078 - accuracy: 0.4889
Epoch 20/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7198 - accuracy: 0.4556
>#3 validation accuracy: 65.217
Steps per epoch: 90
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_4 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_4 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 4s 50ms/step - loss: 0.8234 - accuracy: 0.5000
Epoch 2/20
90/90 [==============================] - 5s 51ms/step - loss: 0.7338 - accuracy: 0.5778
Epoch 3/20
90/90 [==============================] - 4s 48ms/step - loss: 0.7236 - accuracy: 0.5444
Epoch 4/20
90/90 [==============================] - 5s 56ms/step - loss: 0.7371 - accuracy: 0.4889
Epoch 5/20
90/90 [==============================] - 4s 49ms/step - loss: 0.8142 - accuracy: 0.3778
Epoch 6/20
90/90 [==============================] - 5s 55ms/step - loss: 0.7536 - accuracy: 0.5333
Epoch 7/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7054 - accuracy: 0.5222
Epoch 8/20
90/90 [==============================] - 4s 43ms/step - loss: 0.7811 - accuracy: 0.4000
Epoch 9/20
90/90 [==============================] - 5s 59ms/step - loss: 0.7625 - accuracy: 0.4222
Epoch 10/20
90/90 [==============================] - 4s 47ms/step - loss: 0.7349 - accuracy: 0.4111
Epoch 11/20
90/90 [==============================] - 6s 64ms/step - loss: 0.7431 - accuracy: 0.4333
Epoch 12/20
90/90 [==============================] - 5s 52ms/step - loss: 0.7226 - accuracy: 0.4889
Epoch 13/20
90/90 [==============================] - 5s 54ms/step - loss: 0.7091 - accuracy: 0.5667
Epoch 14/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7308 - accuracy: 0.4889
Epoch 15/20
90/90 [==============================] - 4s 47ms/step - loss: 0.7381 - accuracy: 0.4000
Epoch 16/20
90/90 [==============================] - 4s 42ms/step - loss: 0.7110 - accuracy: 0.5667
Epoch 17/20
90/90 [==============================] - 4s 43ms/step - loss: 0.6966 - accuracy: 0.5222
Epoch 18/20
90/90 [==============================] - 4s 42ms/step - loss: 0.7547 - accuracy: 0.4778
Epoch 19/20
90/90 [==============================] - 4s 47ms/step - loss: 0.7560 - accuracy: 0.3556
Epoch 20/20
90/90 [==============================] - 4s 48ms/step - loss: 0.7113 - accuracy: 0.4667
>#4 validation accuracy: 65.217
Steps per epoch: 90
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_5 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_5 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_10 (Dense)             (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 5s 51ms/step - loss: 0.7688 - accuracy: 0.4222
Epoch 2/20
90/90 [==============================] - 5s 57ms/step - loss: 0.7691 - accuracy: 0.4667
Epoch 3/20
90/90 [==============================] - 6s 66ms/step - loss: 0.7338 - accuracy: 0.4667
Epoch 4/20
90/90 [==============================] - 5s 61ms/step - loss: 0.7266 - accuracy: 0.5222
Epoch 5/20
90/90 [==============================] - 5s 56ms/step - loss: 0.7911 - accuracy: 0.3889
Epoch 6/20
90/90 [==============================] - 5s 51ms/step - loss: 0.7454 - accuracy: 0.4556
Epoch 7/20
90/90 [==============================] - 4s 48ms/step - loss: 0.7398 - accuracy: 0.4889
Epoch 8/20
90/90 [==============================] - 5s 56ms/step - loss: 0.7128 - accuracy: 0.4667
Epoch 9/20
90/90 [==============================] - 5s 52ms/step - loss: 0.7346 - accuracy: 0.4333
Epoch 10/20
90/90 [==============================] - 6s 64ms/step - loss: 0.7223 - accuracy: 0.4889
Epoch 11/20
90/90 [==============================] - 6s 68ms/step - loss: 0.7218 - accuracy: 0.4889
Epoch 12/20
90/90 [==============================] - 5s 55ms/step - loss: 0.7244 - accuracy: 0.5000
Epoch 13/20
90/90 [==============================] - 7s 73ms/step - loss: 0.7368 - accuracy: 0.4444
Epoch 14/20
90/90 [==============================] - 5s 52ms/step - loss: 0.7087 - accuracy: 0.5333
Epoch 15/20
90/90 [==============================] - 6s 61ms/step - loss: 0.7055 - accuracy: 0.4333
Epoch 16/20
90/90 [==============================] - 4s 46ms/step - loss: 0.6986 - accuracy: 0.5333
Epoch 17/20
90/90 [==============================] - 4s 46ms/step - loss: 0.7340 - accuracy: 0.4889
Epoch 18/20
90/90 [==============================] - 4s 48ms/step - loss: 0.7221 - accuracy: 0.4889
Epoch 19/20
90/90 [==============================] - 4s 49ms/step - loss: 0.7081 - accuracy: 0.5111
Epoch 20/20
90/90 [==============================] - 4s 44ms/step - loss: 0.7156 - accuracy: 0.4889
>#5 validation accuracy: 65.217
[65.21739363670349, 65.21739363670349, 65.21739363670349, 65.21739363670349, 65.21739363670349]
Accuracy: 65.217% (+/-0.000)

