lstm-rnn-50-features-centered.md

def evaluate_model(trainX, trainy, testX, testy):
    verbose, epochs = 1, 10
    
    n_features = 50
    n_outputs = 2
    n_steps_per_epoch = len(trainX)
    n_steps_per_epoch = 360
    
    lstm_units = 100
    
    optimizer = Adam(lr=0.001)
        
    model = Sequential()
    model.add(LSTM(lstm_units, input_shape=(None, n_features)))
    model.add(Dropout(0.5))
    model.add(Dense(lstm_units, activation='relu'))
    model.add(Dense(n_outputs, activation='softmax'))
    model.compile(loss='categorical_crossentropy',
                  optimizer=optimizer,
                  metrics=['accuracy'])
    
    print(model.summary())
    # fit network
    model.fit_generator(train_generator(trainX, trainy), steps_per_epoch=n_steps_per_epoch, epochs=epochs, verbose=verbose)
    # evaluate model
    _, accuracy = model.evaluate_generator(train_generator(testX, testy), steps=len(testX), verbose=0)
    
    return accuracy

Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_1 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/10
360/360 [==============================] - 16s 46ms/step - loss: 0.7807 - accuracy: 0.4833
Epoch 2/10
360/360 [==============================] - 16s 44ms/step - loss: 0.7677 - accuracy: 0.4806
Epoch 3/10
360/360 [==============================] - 18s 50ms/step - loss: 0.7361 - accuracy: 0.5139
Epoch 4/10
360/360 [==============================] - 16s 46ms/step - loss: 0.7309 - accuracy: 0.4667
Epoch 5/10
360/360 [==============================] - 17s 48ms/step - loss: 0.7391 - accuracy: 0.4500
Epoch 6/10
360/360 [==============================] - 19s 52ms/step - loss: 0.7417 - accuracy: 0.4000
Epoch 7/10
360/360 [==============================] - 21s 60ms/step - loss: 0.7005 - accuracy: 0.5194
Epoch 8/10
360/360 [==============================] - 20s 56ms/step - loss: 0.7234 - accuracy: 0.4639
Epoch 9/10
360/360 [==============================] - 19s 53ms/step - loss: 0.7044 - accuracy: 0.4722
Epoch 10/10
360/360 [==============================] - 18s 50ms/step - loss: 0.7114 - accuracy: 0.4444
>#1 validation accuracy: 69.565
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_2 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_2 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/10
360/360 [==============================] - 26s 73ms/step - loss: 0.7769 - accuracy: 0.4778
Epoch 2/10
360/360 [==============================] - 22s 61ms/step - loss: 0.7230 - accuracy: 0.5333
Epoch 3/10
360/360 [==============================] - 28s 77ms/step - loss: 0.7569 - accuracy: 0.4556
Epoch 4/10
360/360 [==============================] - 23s 64ms/step - loss: 0.7221 - accuracy: 0.4750
Epoch 5/10
360/360 [==============================] - 21s 59ms/step - loss: 0.7169 - accuracy: 0.5028
Epoch 6/10
360/360 [==============================] - 20s 56ms/step - loss: 0.7283 - accuracy: 0.4528
Epoch 7/10
360/360 [==============================] - 18s 51ms/step - loss: 0.7053 - accuracy: 0.4417
Epoch 8/10
360/360 [==============================] - 18s 51ms/step - loss: 0.7127 - accuracy: 0.4694
Epoch 9/10
360/360 [==============================] - 20s 54ms/step - loss: 0.7114 - accuracy: 0.4944
Epoch 10/10
360/360 [==============================] - 19s 52ms/step - loss: 0.7136 - accuracy: 0.4889
>#2 validation accuracy: 73.913
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_3 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_3 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_6 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/10
360/360 [==============================] - 20s 55ms/step - loss: 0.8017 - accuracy: 0.4917
Epoch 2/10
360/360 [==============================] - 20s 55ms/step - loss: 0.7771 - accuracy: 0.4667
Epoch 3/10
360/360 [==============================] - 17s 48ms/step - loss: 0.7514 - accuracy: 0.4583
Epoch 4/10
360/360 [==============================] - 17s 47ms/step - loss: 0.7462 - accuracy: 0.4389
Epoch 5/10
360/360 [==============================] - 18s 50ms/step - loss: 0.7111 - accuracy: 0.5111
Epoch 6/10
360/360 [==============================] - 25s 68ms/step - loss: 0.7220 - accuracy: 0.4528
Epoch 7/10
360/360 [==============================] - 23s 65ms/step - loss: 0.7090 - accuracy: 0.5250
Epoch 8/10
360/360 [==============================] - 21s 60ms/step - loss: 0.7202 - accuracy: 0.47221s
Epoch 9/10
360/360 [==============================] - 18s 50ms/step - loss: 0.7109 - accuracy: 0.4778
Epoch 10/10
360/360 [==============================] - 19s 54ms/step - loss: 0.7044 - accuracy: 0.5139
>#3 validation accuracy: 69.565
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_4 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_4 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_8 (Dense)              (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/10
360/360 [==============================] - 20s 56ms/step - loss: 0.8075 - accuracy: 0.4889
Epoch 2/10
360/360 [==============================] - 18s 49ms/step - loss: 0.7593 - accuracy: 0.4778
Epoch 3/10
360/360 [==============================] - 20s 54ms/step - loss: 0.7420 - accuracy: 0.4694
Epoch 4/10
360/360 [==============================] - 19s 52ms/step - loss: 0.7388 - accuracy: 0.4639
Epoch 5/10
360/360 [==============================] - 19s 53ms/step - loss: 0.7131 - accuracy: 0.4944
Epoch 6/10
360/360 [==============================] - 22s 61ms/step - loss: 0.7118 - accuracy: 0.4806
Epoch 7/10
360/360 [==============================] - 23s 63ms/step - loss: 0.7163 - accuracy: 0.4944
Epoch 8/10
360/360 [==============================] - 19s 53ms/step - loss: 0.7169 - accuracy: 0.4944
Epoch 9/10
360/360 [==============================] - 19s 52ms/step - loss: 0.7131 - accuracy: 0.4361
Epoch 10/10
360/360 [==============================] - 19s 52ms/step - loss: 0.7038 - accuracy: 0.4639
>#4 validation accuracy: 30.435
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_5 (LSTM)                (None, 100)               60400     
_________________________________________________________________
dropout_5 (Dropout)          (None, 100)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 100)               10100     
_________________________________________________________________
dense_10 (Dense)             (None, 2)                 202       
=================================================================
Total params: 70,702
Trainable params: 70,702
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/10
360/360 [==============================] - 18s 49ms/step - loss: 0.7592 - accuracy: 0.4806
Epoch 2/10
360/360 [==============================] - 18s 49ms/step - loss: 0.7655 - accuracy: 0.4750
Epoch 3/10
360/360 [==============================] - 25s 70ms/step - loss: 0.7422 - accuracy: 0.4528
Epoch 4/10
360/360 [==============================] - 22s 62ms/step - loss: 0.7313 - accuracy: 0.4806
Epoch 5/10
360/360 [==============================] - 21s 57ms/step - loss: 0.7200 - accuracy: 0.4444
Epoch 6/10
360/360 [==============================] - 20s 56ms/step - loss: 0.7169 - accuracy: 0.4556
Epoch 7/10
360/360 [==============================] - 18s 50ms/step - loss: 0.7061 - accuracy: 0.4944
Epoch 8/10
360/360 [==============================] - 20s 56ms/step - loss: 0.7102 - accuracy: 0.4528
Epoch 9/10
360/360 [==============================] - 20s 56ms/step - loss: 0.7000 - accuracy: 0.4972
Epoch 10/10
360/360 [==============================] - 21s 58ms/step - loss: 0.7174 - accuracy: 0.4722
>#5 validation accuracy: 52.174
[69.5652186870575, 73.9130437374115, 69.5652186870575, 30.434781312942505, 52.173912525177]
Accuracy: 59.130% (+/-16.175)